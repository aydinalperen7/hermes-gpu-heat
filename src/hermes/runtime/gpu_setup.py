def launch_1d(n_elems, threads=128):    """Return (blocks, threads) for a 1D CUDA launch."""    blocks = (n_elems + (threads - 1)) // threads    return blocks, threadsdef launch_3d(nx, ny, nz, threads=128):    """Return (blocks, threads) for a flattened 3D domain."""    return launch_1d(nx * ny * nz, threads)def launch_bc(n_face, threads=128):    """Return (blocks, threads) for face-sized launches (e.g. nx*nz, nx*ny)."""    return launch_1d(n_face, threads)